<div class="container custom-margin">
  <div class="row">
    <div class="col-12 col-md-8 col-lg-7">
      <div class="billing-card p-4 mb-4">
        <h5 class="fw-bold mb-3">Dirección de facturación</h5>
        <div class="form-check mb-3">
          <input class="form-check-input" type="radio" name="billingAddress" id="saved-address"/>
          <label class="form-check-label" for="saved-address">
            <div>Nombre Usuario</div>
            <div>Dirección</div>
          </label>
        </div>
        <button class="btn btn-address fw-bold" data-bs-toggle="modal" data-bs-target="#address-modal">+ Agregar Nueva Dirección</button>
      </div>
      <div class="billing-card p-4">
        <h5 class="fw-bold mb-3">Confirmar y Pagar</h5>
        <div *ngFor="let p of cartItems" class="product-confirm-card d-flex mb-3 align-items-center">
          <div class="img-wrapper">
            <img [src]="p.image" alt="Producto" class="product-img" />
          </div>
          <div class="ms-3">
            <p class="fw-bold mb-1">{{ p.title }}</p>
            <p class="mb-1"><strong>Talla:</strong> {{ p.size }}</p>
            <p class="mb-0"><strong>Precio:</strong>{{ p.price | number:'1.2-2' }}€ × {{ p.quantity }}</p>
          </div>
        </div>
        <div class="mt-4 mb-3">
          <h6 class="fw-bold mb-2">Método pago</h6>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="paymentMethod" id="pm-card" [(ngModel)]="selectedPaymentMethod" value="Tarjeta de crédito/débito"/>
            <label class="form-check-label" for="pm-card">Tarjeta de crédito/débito</label>
          </div>
          <button class="btn btn-payment fw-bold mt-3" data-bs-toggle="modal" data-bs-target="#payment-modal">+ Agregar Nuevo Método de Pago</button>
        </div>
        <div class="d-flex align-items-center justify-content-between mt-3 terms-and-action">
          <div class="form-check mb-0">
            <input class="form-check-input" type="checkbox" id="terms" [(ngModel)]="termsAccepted"/>
            <label class="form-check-label small" for="terms">Acepto los términos y condiciones de la compra.</label>
          </div>
          <button class="btn fw-bold btn-finish" (click)="finishPurchase()">Finalizar la Compra</button>
        </div>
      </div>
    </div>
    <div class="col-12 col-md-4 col-lg-4 mt-4 mt-md-0">
      <div class="summary-card p-3">
        <h5 class="fw-bold mb-3">Resumen del Pedido</h5>
        <div class="d-flex justify-content-between">
          <span>Precio Total ({{ cartItems.length }} artículos)</span>
          <strong>{{ subtotal | number:'1.2-2' }}€</strong>
        </div>
        <div class="d-flex justify-content-between my-2">
          <span>Envío estándar</span>
          <strong>{{ shippingCost }}€</strong>
        </div>
        <hr class="my-3 opacity-100" />
        <div class="d-flex justify-content-between mb-3">
          <span>Total</span>
          <strong>{{ totalPrice }}€</strong>
        </div>
      </div>
    </div>
  </div>
  <app-address></app-address>
  <app-payment-method></app-payment-method>
</div>
